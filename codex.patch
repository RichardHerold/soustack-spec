 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/defs/common.schema.json b/defs/common.schema.json
index 99545ee0cf01cb529262e9bfd9442036186e27ac..b39c5a904327222b31734a5df1b66c8b523c230e 100644
--- a/defs/common.schema.json
+++ b/defs/common.schema.json
@@ -1,48 +1,44 @@
 {
   "$schema": "https://json-schema.org/draft/2020-12/schema",
   "$id": "https://soustack.spec/defs/common.schema.json",
   "title": "Common definitions for Soustack",
   "type": "object",
   "properties": {
     "stackId": {
       "type": "string",
-      "enum": [
-        "quantified",
-        "quantified@1",
-        "structured",
-        "structured@1",
-        "timed",
-        "timed@1",
-        "referenced",
-        "referenced@1",
-        "compute",
-        "compute@1",
-        "storage",
-        "storage@1",
-        "dietary",
-        "dietary@1",
-        "substitutions",
-        "substitutions@1",
-        "techniques",
-        "techniques@1",
-        "illustrated",
-        "illustrated@1",
-        "scaling",
-        "scaling@1"
+      "anyOf": [
+        {
+          "enum": [
+            "quantified@1",
+            "structured@1",
+            "timed@1",
+            "referenced@1",
+            "compute@1",
+            "storage@1",
+            "dietary@1",
+            "substitutions@1",
+            "techniques@1",
+            "illustrated@1",
+            "scaling@1"
+          ]
+        },
+        {
+          "pattern": "^x-[A-Za-z0-9_-]+@[1-9][0-9]*$"
+        }
       ]
     },
     "extensionLane": {
       "type": "string",
       "pattern": "^x-[A-Za-z0-9_-]+$"
     },
     "extensionLaneValue": {
       "description": "Accept any JSON value for extension lanes while keeping the top-level property name constrained.",
       "type": ["object", "array", "string", "number", "boolean", "null"]
     },
     "uri": {
       "type": "string",
       "format": "uri"
     }
   },
   "additionalProperties": false
 }
diff --git a/fixtures/content/illustrated-step.valid.json b/fixtures/content/illustrated-step.valid.json
index 12d746829652bd96b2b4e463579ddb75cea23b6b..d2bf3eadbae88b9dd9238fcb445969116929e1a5 100644
--- a/fixtures/content/illustrated-step.valid.json
+++ b/fixtures/content/illustrated-step.valid.json
@@ -1,15 +1,15 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "lite",
-  "stacks": ["structured", "illustrated"],
+  "stacks": ["structured@1", "illustrated@1"],
   "name": "Picture Smoothie",
   "ingredients": ["fruit", "yogurt"],
   "instructions": [
     {
       "id": "s1",
       "text": "blend",
       "images": ["http://example.com/blend.jpg"]
     }
   ],
   "images": ["http://example.com/cover2.jpg"]
 }
diff --git a/fixtures/level/base-full.valid.json b/fixtures/level/base-full.valid.json
index 7dd2d00eee87d119248c5cc3daa5d65f6614aa4e..f307d850ecdeb1e89653dfb0b9907f14fe33c968 100644
--- a/fixtures/level/base-full.valid.json
+++ b/fixtures/level/base-full.valid.json
@@ -1,29 +1,29 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "base",
-  "stacks": ["quantified", "structured", "timed", "referenced", "compute", "storage", "dietary", "substitutions", "techniques", "illustrated"],
+  "stacks": ["quantified@1", "structured@1", "timed@1", "referenced@1", "compute@1", "storage@1", "dietary@1", "substitutions@1", "techniques@1", "illustrated@1"],
   "name": "Garlic Pasta",
   "yield": { "amount": 4, "unit": "servings" },
   "time": { "total": { "minutes": 45 } },
   "ingredients": [
     { "id": "i1", "name": "pasta", "quantity": { "amount": 500, "unit": "g" } },
     { "id": "i2", "name": "garlic", "quantity": { "amount": 4, "unit": "clove" } }
   ],
   "instructions": [
     {
       "id": "s1",
       "text": "Boil water",
       "timing": { "activity": "active", "duration": { "minutes": 10 } },
       "inputs": ["i1"],
       "techniqueIds": ["t1"],
       "images": ["http://example.com/step1.jpg"]
     },
     {
       "id": "s2",
       "text": "Cook pasta",
       "timing": { "activity": "active", "duration": { "minMinutes": 8, "maxMinutes": 10 } },
       "dependsOn": ["s1"],
       "inputs": ["i1"],
       "techniqueIds": ["t2"],
       "temperature": { "target": "water", "level": "high" },
       "videos": ["http://example.com/v1.mp4"]
diff --git a/fixtures/stacks/compute-missing-timed.invalid.json b/fixtures/stacks/compute-missing-timed.invalid.json
index 9825b8da24fba96d26f6488ea7a73cead083ea8f..6a8780626c3af3828ec657c1fe0a3096204e4a7c 100644
--- a/fixtures/stacks/compute-missing-timed.invalid.json
+++ b/fixtures/stacks/compute-missing-timed.invalid.json
@@ -1,14 +1,14 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "base",
-  "stacks": ["quantified", "compute"],
+  "stacks": ["quantified@1", "compute@1"],
   "name": "Compute Without Timed",
   "yield": { "amount": 1, "unit": "dish" },
   "time": { "total": { "minutes": 10 } },
   "ingredients": [
     { "id": "i1", "name": "item", "quantity": { "amount": 1, "unit": "cup" } }
   ],
   "instructions": [
     { "text": "do" }
   ]
 }
diff --git a/fixtures/stacks/dietary-no-signal.invalid.json b/fixtures/stacks/dietary-no-signal.invalid.json
index ed35dec41afd34c5323c8de00897e4d01312d8ca..37522b079e5e5b7ba9142623ba34069e0d8053a9 100644
--- a/fixtures/stacks/dietary-no-signal.invalid.json
+++ b/fixtures/stacks/dietary-no-signal.invalid.json
@@ -1,11 +1,11 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "lite",
-  "stacks": ["dietary"],
+  "stacks": ["dietary@1"],
   "name": "Empty Nutrition",
   "ingredients": ["water"],
   "instructions": ["drink"],
   "dietary": {
     "basis": "perServing"
   }
 }
diff --git a/fixtures/stacks/illustrated-empty.invalid.json b/fixtures/stacks/illustrated-empty.invalid.json
index bb2489f0d67c658e28fb6d52c8e212d056e5b712..bfc7f42e5434e235d1fb2bbf0972dad0290053e2 100644
--- a/fixtures/stacks/illustrated-empty.invalid.json
+++ b/fixtures/stacks/illustrated-empty.invalid.json
@@ -1,8 +1,8 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "lite",
-  "stacks": ["illustrated"],
+  "stacks": ["illustrated@1"],
   "name": "No Media",
   "ingredients": ["thing"],
   "instructions": ["step"]
 }
diff --git a/fixtures/stacks/quantified-string.invalid.json b/fixtures/stacks/quantified-string.invalid.json
index b4b0fea6179f462d48866e97e762f25716bc6530..064b617ef5226e45839c7bb98a3eead63b90cb68 100644
--- a/fixtures/stacks/quantified-string.invalid.json
+++ b/fixtures/stacks/quantified-string.invalid.json
@@ -1,10 +1,10 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "base",
-  "stacks": ["quantified"],
+  "stacks": ["quantified@1"],
   "name": "Bad Quant",
   "yield": { "amount": 1, "unit": "dish" },
   "time": { "total": { "minutes": 5 } },
   "ingredients": ["1 cup mystery"],
   "instructions": ["mix"]
 }
diff --git a/fixtures/stacks/referenced-missing-input.invalid.json b/fixtures/stacks/referenced-missing-input.invalid.json
index ccdbacf121a5276c770baed012a11d1f45f0a3bb..69a45e5f22f6cd4ca7c8cac38b3e87a0bae977ba 100644
--- a/fixtures/stacks/referenced-missing-input.invalid.json
+++ b/fixtures/stacks/referenced-missing-input.invalid.json
@@ -1,14 +1,14 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "base",
-  "stacks": ["structured", "referenced"],
+  "stacks": ["structured@1", "referenced@1"],
   "name": "Missing Input",
   "yield": { "amount": 1, "unit": "dish" },
   "time": { "total": { "minutes": 20 } },
   "ingredients": [
     { "id": "i1", "name": "Thing" }
   ],
   "instructions": [
     { "id": "s1", "text": "Do it", "inputs": ["i2"] }
   ]
 }
diff --git a/fixtures/stacks/storage-min.valid.json b/fixtures/stacks/storage-min.valid.json
index 54dcf756142eb8ebea007e4a916b29358c978ca9..d34816e3a1acfce89d98039ee206f898d18ed8d6 100644
--- a/fixtures/stacks/storage-min.valid.json
+++ b/fixtures/stacks/storage-min.valid.json
@@ -1,11 +1,11 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "lite",
-  "stacks": ["storage"],
+  "stacks": ["storage@1"],
   "name": "Leftover Soup",
   "ingredients": ["soup"],
   "instructions": ["reheat when ready"],
   "storage": {
     "refrigerated": { "duration": { "iso8601": "P3D" } }
   }
 }
diff --git a/fixtures/stacks/storage-no-duration.invalid.json b/fixtures/stacks/storage-no-duration.invalid.json
index 9a7433a7dfe4b74a57a7b02fc6ea14c8a25d97f5..783ed64b1245656994661b409109941a70d142f6 100644
--- a/fixtures/stacks/storage-no-duration.invalid.json
+++ b/fixtures/stacks/storage-no-duration.invalid.json
@@ -1,11 +1,11 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "lite",
-  "stacks": ["storage"],
+  "stacks": ["storage@1"],
   "name": "Bad Storage",
   "ingredients": ["food"],
   "instructions": ["store"],
   "storage": {
     "frozen": {}
   }
 }
diff --git a/fixtures/stacks/timed-implies-structured.valid.json b/fixtures/stacks/timed-implies-structured.valid.json
index 071d06b44660777e79096494a068d9fb53b5b65d..f94be554599104ae6da28764479d879983581f11 100644
--- a/fixtures/stacks/timed-implies-structured.valid.json
+++ b/fixtures/stacks/timed-implies-structured.valid.json
@@ -1,25 +1,25 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "base",
-  "stacks": ["timed"],
+  "stacks": ["timed@1"],
   "name": "Rested dough",
   "yield": { "amount": 2, "unit": "loaves" },
   "time": { "total": { "minutes": 180 } },
   "ingredients": [
     { "id": "f", "name": "flour" },
     { "id": "w", "name": "water" }
   ],
   "instructions": [
     {
       "id": "mix",
       "text": "Mix flour and water",
       "timing": { "activity": "active", "duration": { "minutes": 10 } }
     },
     {
       "id": "rest",
       "text": "Let the dough rest",
       "dependsOn": ["mix"],
       "timing": { "activity": "passive", "completionCue": "doubled in size" }
     }
   ]
 }
diff --git a/fixtures/stacks/timed-range.invalid.json b/fixtures/stacks/timed-range.invalid.json
index 19b618eec319c6325c4b4f30266671bc6852f8a1..1aef50999800635eedb459ecb03e6ddb1038970e 100644
--- a/fixtures/stacks/timed-range.invalid.json
+++ b/fixtures/stacks/timed-range.invalid.json
@@ -1,16 +1,16 @@
 {
   "$schema": "https://soustack.spec/soustack.schema.json",
   "level": "base",
-  "stacks": ["structured", "timed"],
+  "stacks": ["structured@1", "timed@1"],
   "name": "Bad Range",
   "yield": { "amount": 2, "unit": "servings" },
   "time": { "total": { "minutes": 15 } },
   "ingredients": ["water"],
   "instructions": [
     {
       "id": "s1",
       "text": "Wait",
       "timing": { "activity": "passive", "duration": { "minMinutes": 10, "maxMinutes": 5 } }
     }
   ]
 }
diff --git a/scripts/validate-fixtures.mjs b/scripts/validate-fixtures.mjs
index 3c6e9374cbee5243198cca891a35d63cbc8ffa4c..5a3aa01ed0ce8d0fb0a3af389553d5d67e896f1b 100644
--- a/scripts/validate-fixtures.mjs
+++ b/scripts/validate-fixtures.mjs
@@ -15,60 +15,51 @@ async function loadSchemas() {
       if (entry.endsWith('.json')) schemaFiles.push(join(dir, entry));
     }
   }
   schemaFiles.push('soustack.schema.json');
 
   for (const file of schemaFiles) {
     const json = JSON.parse(await readFile(file, 'utf8'));
     ajv.addSchema(json, json.$id || file);
   }
 }
 
 async function walk(dir) {
   const files = [];
   const entries = await readdir(dir, { withFileTypes: true });
   for (const entry of entries) {
     const full = join(dir, entry.name);
     if (entry.isDirectory()) {
       files.push(...(await walk(full)));
     } else if (extname(full) === '.json') {
       files.push(full);
     }
   }
   return files;
 }
 
-function normalizeStacks(list = []) {
-  const set = new Set();
-  for (const entry of list) {
-    if (typeof entry !== 'string') continue;
-    set.add(entry);
-    const base = entry.split('@')[0];
-    set.add(base);
-  }
-  return set;
-}
+const normalizeStacks = (list = []) => new Set(Array.isArray(list) ? list.filter((entry) => typeof entry === 'string') : []);
 
 function collectIngredients(ingredients = []) {
   const list = [];
   for (const item of ingredients) {
     if (item && typeof item === 'object' && Array.isArray(item.ingredients)) {
       list.push(...collectIngredients(item.ingredients));
     } else if (item && typeof item === 'object') {
       list.push(item);
     }
   }
   return list;
 }
 
 function collectSteps(instructions = []) {
   const steps = [];
   for (const entry of instructions) {
     if (entry && typeof entry === 'object' && Array.isArray(entry.steps)) {
       steps.push(...collectSteps(entry.steps));
     } else if (entry && typeof entry === 'object') {
       steps.push(entry);
     }
   }
   return steps;
 }
 
@@ -130,136 +121,136 @@ function validateDAG(steps) {
 
 function checkConformance(data, file) {
   const errors = [];
   const stacks = normalizeStacks(data.stacks || []);
   const ingredients = collectIngredients(data.ingredients);
   const steps = collectSteps(data.instructions);
 
   for (const ingredient of ingredients) {
     const issue = validateTemperatureRange(ingredient.temperature, 'ingredient');
     if (issue) errors.push(issue);
   }
   for (const step of steps) {
     const issue = validateTemperatureRange(step.temperature, `step ${step.id || ''}`.trim());
     if (issue) errors.push(issue);
   }
 
   if (ingredients.length) {
     const dup = uniqueCheck(ingredients, 'id', 'ingredient');
     if (dup) errors.push(dup);
   }
   if (steps.length) {
     const dup = uniqueCheck(steps, 'id', 'step');
     if (dup) errors.push(dup);
   }
 
-  if (stacks.has('structured') || stacks.has('timed') || stacks.has('referenced')) {
+  if (stacks.has('structured@1') || stacks.has('timed@1') || stacks.has('referenced@1')) {
     const dagIssue = validateDAG(steps);
     if (dagIssue) errors.push(dagIssue);
   }
 
-  if (stacks.has('referenced')) {
+  if (stacks.has('referenced@1')) {
     const ids = new Set(ingredients.map((i) => i.id));
     for (const step of steps) {
       if (!Array.isArray(step.inputs) || step.inputs.length === 0) {
         errors.push('referenced step missing inputs');
         continue;
       }
       for (const input of step.inputs) {
         if (!ids.has(input)) errors.push(`referenced input missing ingredient id: ${input}`);
       }
     }
   }
 
-  if (stacks.has('timed')) {
+  if (stacks.has('timed@1')) {
     for (const step of steps) {
       const duration = step?.timing?.duration;
       if (duration && typeof duration === 'object' && 'minMinutes' in duration && 'maxMinutes' in duration) {
         if (!(duration.minMinutes <= duration.maxMinutes)) {
           errors.push('timed duration minMinutes must be <= maxMinutes');
         }
       }
     }
   }
 
-  if (stacks.has('compute')) {
-    if (data.level !== 'base' || !stacks.has('quantified') || !stacks.has('timed')) {
+  if (stacks.has('compute@1')) {
+    if (data.level !== 'base' || !stacks.has('quantified@1') || !stacks.has('timed@1')) {
       errors.push('compute stack requires base level with quantified and timed stacks');
     }
   }
 
-  if (stacks.has('scaling')) {
+  if (stacks.has('scaling@1')) {
     const ingredientIds = new Set(ingredients.map((i) => i.id));
     for (const ingredient of ingredients) {
       const bp = ingredient?.bakersPercentage;
       if (bp && (!bp.of || !ingredientIds.has(bp.of))) {
         errors.push(`bakersPercentage of references missing ingredient id: ${bp.of || ''}`.trim());
       }
     }
 
     const discrete = data.scaling?.discrete;
     if (discrete && typeof discrete === 'object') {
       if (discrete.min > discrete.max) {
         errors.push('scaling discrete min must be <= max');
       }
     }
   }
 
-  if (stacks.has('illustrated')) {
+  if (stacks.has('illustrated@1')) {
     const stepHasMedia = steps.some((s) => Array.isArray(s.images)?.length || Array.isArray(s.videos)?.length);
     const recipeHasMedia = (Array.isArray(data.images) && data.images.length > 0) ||
       (Array.isArray(data.videos) && data.videos.length > 0);
     if (!stepHasMedia && !recipeHasMedia) {
       errors.push('illustrated stack requires at least one media URI');
     }
   }
 
-  if (stacks.has('dietary')) {
+  if (stacks.has('dietary@1')) {
     if (!data.dietary) {
       errors.push('dietary block missing');
     } else {
       const { calories, macros, diets, allergens } = data.dietary;
       const hasSignal = (calories !== undefined) ||
         (macros && Object.keys(macros).length > 0) ||
         (Array.isArray(diets) && diets.length > 0) ||
         (Array.isArray(allergens) && allergens.length > 0);
       if (!hasSignal) errors.push('dietary stack requires at least one signal');
     }
   }
 
-  if (stacks.has('techniques')) {
+  if (stacks.has('techniques@1')) {
     const glossary = Array.isArray(data.techniques) ? data.techniques : [];
     const glossaryIds = new Set(glossary.map((t) => t.id));
     for (const step of steps) {
       for (const tech of step.techniqueIds || []) {
         if (!glossaryIds.has(tech)) errors.push(`technique reference missing: ${tech}`);
       }
     }
     if (glossary.length === 0) errors.push('techniques stack requires glossary');
   }
 
-  if (stacks.has('storage')) {
+  if (stacks.has('storage@1')) {
     const storage = data.storage || {};
     const methods = ['roomTemp', 'refrigerated', 'frozen'];
     const present = methods.filter((m) => storage[m]);
     if (present.length === 0) errors.push('storage stack requires at least one method');
     for (const method of present) {
       const duration = storage[method]?.duration?.iso8601;
       if (!duration || typeof duration !== 'string' || !duration.startsWith('P')) {
         errors.push(`storage method ${method} missing iso8601 duration`);
       }
     }
   }
 
   return errors;
 }
 
 async function main() {
   await loadSchemas();
   const validate = ajv.getSchema('https://soustack.spec/soustack.schema.json');
   if (!validate) throw new Error('main schema not loaded');
 
   const fixtureFiles = await walk('fixtures');
   let failures = 0;
 
   for (const file of fixtureFiles) {
     const raw = await readFile(file, 'utf8');
diff --git a/soustack.schema.json b/soustack.schema.json
index 3b748b0b6da97ce330827664a67b059253ac3d09..95192b576cdb60581cbc1b066edce01f9b471c84 100644
--- a/soustack.schema.json
+++ b/soustack.schema.json
@@ -58,128 +58,128 @@
       }
     },
     "metadata": { "type": "object", "additionalProperties": true },
     "images": { "type": "array", "items": { "$ref": "./defs/common.schema.json#/properties/uri" } },
     "videos": { "type": "array", "items": { "$ref": "./defs/common.schema.json#/properties/uri" } },
     "dietary": { "$ref": "./stacks/dietary.schema.json#/properties/dietary" },
     "storage": { "$ref": "./stacks/storage.schema.json#/properties/storage" },
     "substitutions": { "$ref": "./stacks/substitutions.schema.json#/properties/substitutions" },
     "techniques": { "$ref": "./stacks/techniques.schema.json#/properties/techniques" },
     "scaling": { "$ref": "./stacks/scaling.schema.json#/properties/scaling" }
   },
   "patternProperties": {
     "^x-": { "$ref": "./defs/common.schema.json#/properties/extensionLaneValue" }
   },
   "required": ["level", "stacks", "name", "ingredients", "instructions"],
   "allOf": [
     {
       "if": { "properties": { "level": { "const": "base" } } },
       "then": { "required": ["yield", "time"] }
     },
     {
       "if": {
         "properties": {
           "stacks": {
             "allOf": [
-              { "contains": { "enum": ["quantified", "quantified@1"] } },
-              { "not": { "contains": { "enum": ["scaling", "scaling@1"] } } }
+              { "contains": { "enum": ["quantified@1"] } },
+              { "not": { "contains": { "enum": ["scaling@1"] } } }
             ]
           }
         }
       },
       "then": {
         "properties": {
           "ingredients": { "$ref": "./stacks/quantified.schema.json#/properties/ingredients" }
         },
         "required": ["ingredients"]
       }
     },
     {
-      "if": { "properties": { "stacks": { "contains": { "enum": ["structured", "structured@1"] } } } },
+      "if": { "properties": { "stacks": { "contains": { "enum": ["structured@1"] } } } },
       "then": {
         "properties": {
           "instructions": { "$ref": "./stacks/structured.schema.json#/properties/instructions" }
         }
       }
     },
     {
-      "if": { "properties": { "stacks": { "contains": { "enum": ["scaling", "scaling@1"] } } } },
+      "if": { "properties": { "stacks": { "contains": { "enum": ["scaling@1"] } } } },
       "then": {
         "properties": {
           "ingredients": { "$ref": "./stacks/scaling.schema.json#/properties/ingredients" },
           "scaling": { "$ref": "./stacks/scaling.schema.json#/properties/scaling" },
-          "stacks": { "contains": { "enum": ["quantified", "quantified@1"] } }
+          "stacks": { "contains": { "enum": ["quantified@1"] } }
         },
         "required": ["ingredients", "scaling"]
       }
     },
     {
-      "if": { "properties": { "stacks": { "contains": { "enum": ["timed", "timed@1"] } } } },
+      "if": { "properties": { "stacks": { "contains": { "enum": ["timed@1"] } } } },
       "then": {
         "properties": {
           "instructions": { "$ref": "./stacks/timed.schema.json#/properties/instructions" }
         }
       }
     },
     {
-      "if": { "properties": { "stacks": { "contains": { "enum": ["referenced", "referenced@1"] } } } },
+      "if": { "properties": { "stacks": { "contains": { "enum": ["referenced@1"] } } } },
       "then": {
         "properties": {
           "ingredients": { "$ref": "./stacks/referenced.schema.json#/properties/ingredients" },
           "instructions": { "$ref": "./stacks/referenced.schema.json#/properties/instructions" }
         },
         "required": ["ingredients", "instructions"]
       }
     },
     {
-      "if": { "properties": { "stacks": { "contains": { "enum": ["compute", "compute@1"] } } } },
+      "if": { "properties": { "stacks": { "contains": { "enum": ["compute@1"] } } } },
       "then": {
         "properties": {
           "level": { "const": "base" },
           "stacks": {
             "allOf": [
-              { "contains": { "enum": ["quantified", "quantified@1"] } },
-              { "contains": { "enum": ["timed", "timed@1"] } }
+              { "contains": { "enum": ["quantified@1"] } },
+              { "contains": { "enum": ["timed@1"] } }
             ]
           }
         }
       }
     },
     {
-      "if": { "properties": { "stacks": { "contains": { "enum": ["storage", "storage@1"] } } } },
+      "if": { "properties": { "stacks": { "contains": { "enum": ["storage@1"] } } } },
       "then": { "required": ["storage"] }
     },
     {
-      "if": { "properties": { "stacks": { "contains": { "enum": ["dietary", "dietary@1"] } } } },
+      "if": { "properties": { "stacks": { "contains": { "enum": ["dietary@1"] } } } },
       "then": { "required": ["dietary"] }
     },
     {
-      "if": { "properties": { "stacks": { "contains": { "enum": ["substitutions", "substitutions@1"] } } } },
+      "if": { "properties": { "stacks": { "contains": { "enum": ["substitutions@1"] } } } },
       "then": { "required": ["substitutions"] }
     },
     {
-      "if": { "properties": { "stacks": { "contains": { "enum": ["techniques", "techniques@1"] } } } },
+      "if": { "properties": { "stacks": { "contains": { "enum": ["techniques@1"] } } } },
       "then": { "required": ["techniques"] }
     }
   ],
   "unevaluatedProperties": false,
   "$defs": {
     "ingredient": {
       "allOf": [
         { "$ref": "./defs/entities.schema.json#/$defs/IngredientBase" }
       ]
     },
     "ingredientSection": {
       "type": "object",
       "properties": {
         "section": { "type": "string" },
         "ingredients": {
           "type": "array",
           "items": {
             "anyOf": [
               { "type": "string" },
               { "$ref": "#/$defs/ingredient" },
               { "$ref": "#/$defs/ingredientSection" }
             ]
           }
         },
         "metadata": { "type": "object", "additionalProperties": true }
 
EOF
)